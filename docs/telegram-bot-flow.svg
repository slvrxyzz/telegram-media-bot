<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="720" viewBox="0 0 1200 720">
  <defs>
    <style>
      .box { fill: #f5f7fb; stroke: #1f2a37; stroke-width: 2; }
      .title { font: 700 18px Arial, sans-serif; fill: #111827; }
      .text { font: 14px Arial, sans-serif; fill: #111827; }
      .small { font: 12px Arial, sans-serif; fill: #374151; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="#1f2a37" />
    </marker>
  </defs>

  <text x="24" y="32" class="title">Схема работы Telegram-бота</text>

  <!-- Top row: main flow -->
  <rect x="40" y="60" width="160" height="60" rx="8" class="box"/>
  <text x="60" y="95" class="text">Пользователь</text>

  <rect x="260" y="60" width="160" height="60" rx="8" class="box"/>
  <text x="300" y="95" class="text">Telegram</text>

  <rect x="480" y="60" width="180" height="60" rx="8" class="box"/>
  <text x="505" y="95" class="text">Bot (Aiogram)</text>

  <rect x="720" y="60" width="180" height="60" rx="8" class="box"/>
  <text x="740" y="95" class="text">Handlers</text>

  <rect x="960" y="60" width="180" height="60" rx="8" class="box"/>
  <text x="1000" y="95" class="text">PostgreSQL</text>

  <line x1="200" y1="90" x2="260" y2="90" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="420" y1="90" x2="480" y2="90" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="660" y1="90" x2="720" y2="90" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="900" y1="90" x2="960" y2="90" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>

  <line x1="960" y1="120" x2="900" y2="120" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="720" y1="120" x2="660" y2="120" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="480" y1="120" x2="420" y2="120" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="260" y1="120" x2="200" y2="120" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>

  <text x="226" y="80" class="small">сообщение</text>
  <text x="440" y="80" class="small">update</text>
  <text x="670" y="80" class="small">router</text>
  <text x="920" y="80" class="small">SQL</text>

  <!-- Upload flow -->
  <text x="40" y="200" class="title">Загрузка контента (FSM)</text>
  <rect x="40" y="220" width="200" height="60" rx="8" class="box"/>
  <text x="60" y="255" class="text">/upload или кнопка</text>

  <rect x="280" y="220" width="200" height="60" rx="8" class="box"/>
  <text x="300" y="255" class="text">Ожидание медиа</text>

  <rect x="520" y="220" width="200" height="60" rx="8" class="box"/>
  <text x="560" y="255" class="text">Фото/видео</text>

  <rect x="760" y="220" width="200" height="60" rx="8" class="box"/>
  <text x="780" y="255" class="text">Ожидание описания</text>

  <rect x="1000" y="220" width="160" height="60" rx="8" class="box"/>
  <text x="1015" y="255" class="text">Сохранение</text>

  <line x1="240" y1="250" x2="280" y2="250" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="480" y1="250" x2="520" y2="250" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="720" y1="250" x2="760" y2="250" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="960" y1="250" x2="1000" y2="250" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Browse flow -->
  <text x="40" y="360" class="title">Просмотр ленты</text>
  <rect x="40" y="380" width="200" height="60" rx="8" class="box"/>
  <text x="80" y="415" class="text">/list</text>

  <rect x="280" y="380" width="260" height="60" rx="8" class="box"/>
  <text x="300" y="415" class="text">SELECT последних записей</text>

  <rect x="580" y="380" width="260" height="60" rx="8" class="box"/>
  <text x="600" y="415" class="text">Медиа + описание</text>

  <rect x="880" y="380" width="280" height="60" rx="8" class="box"/>
  <text x="900" y="415" class="text">Кнопки Пред/След</text>

  <line x1="240" y1="410" x2="280" y2="410" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="540" y1="410" x2="580" y2="410" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="840" y1="410" x2="880" y2="410" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Filter flow -->
  <text x="40" y="520" class="title">Фильтрация</text>
  <rect x="40" y="540" width="260" height="60" rx="8" class="box"/>
  <text x="60" y="575" class="text">/filter #tag days=7</text>

  <rect x="340" y="540" width="300" height="60" rx="8" class="box"/>
  <text x="360" y="575" class="text">SELECT с фильтрами</text>

  <rect x="680" y="540" width="260" height="60" rx="8" class="box"/>
  <text x="700" y="575" class="text">Список результатов</text>

  <line x1="300" y1="570" x2="340" y2="570" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="640" y1="570" x2="680" y2="570" stroke="#1f2a37" stroke-width="2" marker-end="url(#arrow)"/>
</svg>

